#!/bin/sh
#
# Translate real interface names, pppX, ethX et al, to cli interface names.
#

if [ -z "$1" ]; then
    myname=`basename $0`
    echo "$myname: No arguments given. List interfaces to translate." >&2
    echo "Usage:" >&2
    echo "  $myname ifname [ifnames ...]" >&2
    exit 1
fi

. /etc/functions.sh

config_load network

for dev in $CONFIG_SECTIONS;do
    local ifname device

    if [ -z "$dev" ]; then
	continue
    fi

    config_get ifname $dev ifname
    if [ -n "$ifname" ]; then
	sed="$sed s/intfname:$ifname:intfname/$dev/g;"
    fi
    # We want to translate eth0.24 to vlan24 even if running pppoe
    # so we need to check the device name as well
    config_get device $dev device
    if [ -n "$device" ]; then
	sed="$sed s/intfname:$device:intfname/$dev/g;"
    fi
done
sed="$sed s/intfname://g; s/:intfname//g;"

while [ -n "$1" ]; do
    echo "intfname:$1:intfname" | sed "$sed"
    shift
done
